{% extends 'base.html' %}
{% load static %}

{% block content %}

    <section class="grid grid-cols-5 gap-6  w-full">
        <div class="col-start-2 col-end-4 h-[70vh]">
            {% if messages %}

                {% for message in messages %}

                    <p>{{ message }}</p>

                {% endfor %}

            {% endif %}
            <h1 class="text-xl">Create a post</h1>

            <hr class="border-solid border-black my-2">

            <form action="{% url 'create-post' %}" method="post" class="w-full  h-full px-4 border-[1px] border-gray-400 rounded-xl" 
                enctype="multipart/form-data">
                {% csrf_token %}

                <input type="hidden" name="user" value="{{ request.user.id }}">
                
                <div class="pt-4">
                    <ul class="flex items-center justify-between  w-full bg-gray-200 h-[50px]  text-center rounded-xl leading-12">
                        <li class="w-[250px] flex justify-center items-center text-xl cursor-pointer hover:bg-gray-400 hover:rounded-lg h-full border-r-[1px] border-gray-500"
                            onclick="openForm(event, 'post')"
                        >
                            <p >Post</p>
                        </li>
                        <li class="w-[250px] flex justify-center items-center  text-xl cursor-pointer hover:bg-gray-400 h-full border-r-[1px] border-gray-500"
                            onclick="openForm(event, 'image')"
                        >
                            <p >Image</p>
                        </li>
                        <li class="w-[250px] flex justify-center items-center  text-xl cursor-pointer hover:bg-gray-400 h-full"
                            onclick="openForm(event, 'url')"
                        >
                            <p >Link</p>
                        </li>
                    </ul>
                    <input type="text" name="title" placeholder="Title" class="w-full my-4 h-[40px] text-2xl pl-4 border-2 border-gray-200" required>
                    
                    <div id="post" class="tabcontent">
                        <textarea name="body" id="" cols="30" rows="10" placeholder="Text here..." 
                            class="w-full my-4 text-2xl p-4 resize-none border-2 border-gray-200"
                        ></textarea>
                        
                    </div>

                    <div id="image" class="tabcontent hidden">
                        <div>
                            <input type="file" src="" alt="" name="image" accept="image/*" onchange="readURL(this)" class="border-[1px] text-xs">
                            <img src="{% static '/images/images/download.jpg' %}" alt="" id="img-preview" class="object-contain w-[300px] h-[300px] border-[1px] border-solid my-2" >
                        </div>
                        
                    </div>
                    
                    <div id="url" class="tabcontent hidden">
                        <input type="url" name="" id="">
                    </div>
                    
                    
                    
                </div>
                
                
                <button type="submit" class="float-right bg-gray-300 w-[100px] rounded-full py-2 text-xl
                hover:bg-gray-200">Post</button>

            </form>
        </div>

        <div class="bg-gray-200 border-[1px] border-gray-400 rounded-lg p-4">
            <h1>Rules for posting to PostBook</h1>
            <ul>
                <li>1. Don't be an asshole</li>
                <li>2. Remeber no.1</li>
                <li>3. Remeber no.2</li>
                <li>4. Remeber no.3</li>
                <li>5. Or else...</li>
            </ul>
            <h1>That's all, happy posting</h1>
        </div>
    </section>

    <script type="text/javascript">
        var i, tab_id, tab_content, tab_link;
        
        function openForm(event, formType){
            console.log(formType)
            tab_id = document.getElementById(formType)
            tab_content = document.getElementsByClassName('tabcontent')

            // by default, the post tab is already present so user won't have to click on it to display the post tab
            // the rest of the tabs' display will be set to hidden
            for (i = 0 ; i < tab_content.length; i++){
                if (tab_content[i].classList.contains('hidden')){
                    continue;
                }
                tab_content[i].classList.add('hidden')
            }

            // the selected div with the respective id will display 
            document.getElementById(formType).classList.remove('hidden')
            document.getElementById(formType).classList.add('block');
            
                    
        }
        function readURL(input){
            // check if input exists
            if (input.files && input.files[0]){
                //create file reader obj
                var reader = new FileReader()

                // set the img to img preview
                reader.onload = function(e){
                    $('#img-preview').attr('src', e.target.result)
                }

                reader.readAsDataURL(input.files[0])
            }
        }
    </script>

{% endblock %}